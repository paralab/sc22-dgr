// generated by Dendro-GR SymPyGR code gernation framework
//date: 2018-09-27 15:16:33
#include "derivs_bssn.cuh"

namespace cuda {

/**compute derivative kernel __RSWS_computeDerivs */
__global__ void __RSWS_computeDerivs(const double**__unzipInVar,MemoryDerivs* __derivWorkspace, const cuda::_Block* __dendroBlkList, const unsigned int * __gpuBlockMap, const cudaDeviceProp*__deviceProperties){

for(unsigned int blk=__gpuBlockMap[2*blockIdx.x];blk<__gpuBlockMap[2*blockIdx.x+1];++blk){


// blocks assigned to each gpu block 
const _Block dblock=__dendroBlkList[blk];
const unsigned int NUM_SM_UNITS=__deviceProperties->multiProcessorCount;
const unsigned int SM_ID=blockIdx.x%NUM_SM_UNITS;
const unsigned int offset=dblock.getOffset();
const unsigned int *sz=dblock.getSz();
const unsigned int *alignedSz=dblock.getAlignedSz();
const double* hx=dblock.getDx();
const double dx=hx[0];
const double dy=hx[1];
const double dz=hx[2];
const double* ptmin=dblock.getPtMin();
const double* ptmax=dblock.getPtMax();
const unsigned int bflag=dblock.getBFlag();


const unsigned int tile_sz[3]={12,12,12};


//allocate memory for shared deriv variables. 
const unsigned int Lb = 0;// load begin bound
const unsigned int Le = sz[0]-0;// load end bound
	const unsigned int BLK_INTERATIONS = ((Le-Lb)<tile_sz[0])? 1: ((int)ceil((double)(Le-Lb-tile_sz[0])/(tile_sz[0]-2*3)))+1;

unsigned int ijk_lm[3*2];
//allocate memory for shared deriv variables. 


//allocate memory for shared unzip input. 
__shared__ double unzipVarInShared[1728];
__shared__ double unzipVarOutShared[1728];
__shared__ double unzipVarOutShared1[1728];
__shared__ bool beta0[1728];
__shared__ bool beta1[1728];
__shared__ bool beta2[1728];

for(unsigned int iter=0;iter<BLK_INTERATIONS;iter++){

		 ijk_lm[2*0+0]=max(0,(int)(0 + tile_sz[0]*iter -2*iter*3));
		 ijk_lm[2*0+1]=min(ijk_lm[2*0+0]+tile_sz[0],sz[0]-0);

		 ijk_lm[2*1+0]=max(0,(int)(0 + tile_sz[1]*iter -2*iter*3));
		 ijk_lm[2*1+1]=min(ijk_lm[2*1+0]+tile_sz[1],sz[1]-0);

		 ijk_lm[2*2+0]=max(0,(int)(0 + tile_sz[2]*iter -2*iter*3));
		 ijk_lm[2*2+1]=min(ijk_lm[2*2+0]+tile_sz[2],sz[2]-0);
		 //printf(" iter : %d threadid (%d,%d,%d) tile begin: (%d,%d,%d) tile end: (%d,%d,%d) \n",iter, threadIdx.x,threadIdx.y,threadIdx.z,ijk_lm[0],ijk_lm[2],ijk_lm[4],ijk_lm[1],ijk_lm[3],ijk_lm[5]);


		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_BETA0][offset],(double *) unzipVarInShared,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_BETA1][offset],(double *) unzipVarOutShared,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_BETA2][offset],(double *) unzipVarOutShared1,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		cuda::__extractSign3D<double>((double *)unzipVarInShared,(bool *) beta0,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__extractSign3D<double>((double *)unzipVarOutShared,(bool *) beta1,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__extractSign3D<double>((double *)unzipVarOutShared1,(bool *) beta2,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		//load input data from global to shared memory
		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_ALPHA][offset],(double *) unzipVarInShared,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		//sync to make sure all the data is loaded
		// computing deriv x for variable alpha 
		_RSWS_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		// computing deriv xy for variable alpha 
		_RSWS_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_0_1_alpha[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv xz for variable alpha 
		_RSWS_deriv42_z((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_0_2_alpha[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);

		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_0_alpha[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv y for variable alpha 
		_RSWS_deriv42_y((double *) unzipVarOutShared,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		// computing deriv yz for variable alpha 
		_RSWS_deriv42_z((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_1_2_alpha[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);

		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_1_alpha[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv z for variable alpha 
		_RSWS_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_2_alpha[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		_RSWS_deriv42_xx((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		_RSWS_deriv42_yy((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad2_1_1_alpha[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_1_1_alpha[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42_zz((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad2_2_2_alpha[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		_RSWS_ko_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_0_alpha[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_0_alpha[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_ko_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		_RSWS_ko_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_alpha[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_2_alpha[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_alpha[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta0 , 3, bflag);
		_RSWS_deriv42adv_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta1 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_1_alpha[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_1_alpha[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta2 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_alpha[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		//load input data from global to shared memory
		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_BETA0][offset],(double *) unzipVarInShared,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		//sync to make sure all the data is loaded
		// computing deriv x for variable beta0 
		_RSWS_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		// computing deriv xy for variable beta0 
		_RSWS_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_0_1_beta0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv xz for variable beta0 
		_RSWS_deriv42_z((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_0_2_beta0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);

		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_0_beta0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv y for variable beta0 
		_RSWS_deriv42_y((double *) unzipVarOutShared,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		// computing deriv yz for variable beta0 
		_RSWS_deriv42_z((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_1_2_beta0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);

		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_1_beta0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv z for variable beta0 
		_RSWS_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_2_beta0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		_RSWS_deriv42_xx((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		_RSWS_deriv42_yy((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad2_1_1_beta0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_1_1_beta0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42_zz((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad2_2_2_beta0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		_RSWS_ko_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_0_beta0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_0_beta0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_ko_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		_RSWS_ko_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_beta0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_2_beta0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_beta0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta0 , 3, bflag);
		_RSWS_deriv42adv_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta1 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_1_beta0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_1_beta0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta2 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_beta0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		//load input data from global to shared memory
		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_BETA1][offset],(double *) unzipVarInShared,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		//sync to make sure all the data is loaded
		// computing deriv x for variable beta1 
		_RSWS_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		// computing deriv xy for variable beta1 
		_RSWS_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_0_1_beta1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv xz for variable beta1 
		_RSWS_deriv42_z((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_0_2_beta1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);

		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_0_beta1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv y for variable beta1 
		_RSWS_deriv42_y((double *) unzipVarOutShared,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		// computing deriv yz for variable beta1 
		_RSWS_deriv42_z((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_1_2_beta1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);

		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_1_beta1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv z for variable beta1 
		_RSWS_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_2_beta1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		_RSWS_deriv42_xx((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		_RSWS_deriv42_yy((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad2_1_1_beta1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_1_1_beta1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42_zz((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad2_2_2_beta1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		_RSWS_ko_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_0_beta1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_0_beta1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_ko_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		_RSWS_ko_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_beta1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_2_beta1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_beta1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta0 , 3, bflag);
		_RSWS_deriv42adv_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta1 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_1_beta1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_1_beta1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta2 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_beta1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		//load input data from global to shared memory
		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_BETA2][offset],(double *) unzipVarInShared,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		//sync to make sure all the data is loaded
		// computing deriv x for variable beta2 
		_RSWS_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		// computing deriv xy for variable beta2 
		_RSWS_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_0_1_beta2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv xz for variable beta2 
		_RSWS_deriv42_z((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_0_2_beta2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);

		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_0_beta2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv y for variable beta2 
		_RSWS_deriv42_y((double *) unzipVarOutShared,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		// computing deriv yz for variable beta2 
		_RSWS_deriv42_z((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_1_2_beta2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);

		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_1_beta2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv z for variable beta2 
		_RSWS_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_2_beta2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		_RSWS_deriv42_xx((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		_RSWS_deriv42_yy((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad2_1_1_beta2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_1_1_beta2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42_zz((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad2_2_2_beta2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		_RSWS_ko_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_0_beta2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_0_beta2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_ko_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		_RSWS_ko_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_beta2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_2_beta2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_beta2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta0 , 3, bflag);
		_RSWS_deriv42adv_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta1 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_1_beta2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_1_beta2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta2 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_beta2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		//load input data from global to shared memory
		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_B0][offset],(double *) unzipVarInShared,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		//sync to make sure all the data is loaded
		// computing deriv x for variable B0 
		_RSWS_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_0_B0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv y for variable B0 
		_RSWS_deriv42_y((double *) unzipVarOutShared,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_1_B0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv z for variable B0 
		_RSWS_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_2_B0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();


		_RSWS_ko_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		_RSWS_ko_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_1_B0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_1_B0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_ko_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_B0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta0 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_0_B0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_0_B0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta1 , 3, bflag);
		_RSWS_deriv42adv_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta2 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_B0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_2_B0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_B0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		//load input data from global to shared memory
		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_B1][offset],(double *) unzipVarInShared,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		//sync to make sure all the data is loaded
		// computing deriv x for variable B1 
		_RSWS_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_0_B1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv y for variable B1 
		_RSWS_deriv42_y((double *) unzipVarOutShared,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_1_B1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv z for variable B1 
		_RSWS_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_2_B1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();


		_RSWS_ko_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		_RSWS_ko_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_1_B1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_1_B1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_ko_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_B1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta0 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_0_B1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_0_B1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta1 , 3, bflag);
		_RSWS_deriv42adv_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta2 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_B1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_2_B1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_B1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		//load input data from global to shared memory
		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_B2][offset],(double *) unzipVarInShared,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		//sync to make sure all the data is loaded
		// computing deriv x for variable B2 
		_RSWS_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_0_B2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv y for variable B2 
		_RSWS_deriv42_y((double *) unzipVarOutShared,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_1_B2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv z for variable B2 
		_RSWS_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_2_B2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();


		_RSWS_ko_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		_RSWS_ko_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_1_B2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_1_B2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_ko_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_B2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta0 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_0_B2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_0_B2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta1 , 3, bflag);
		_RSWS_deriv42adv_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta2 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_B2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_2_B2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_B2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		//load input data from global to shared memory
		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_CHI][offset],(double *) unzipVarInShared,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		//sync to make sure all the data is loaded
		// computing deriv x for variable chi 
		_RSWS_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		// computing deriv xy for variable chi 
		_RSWS_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_0_1_chi[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv xz for variable chi 
		_RSWS_deriv42_z((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_0_2_chi[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);

		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_0_chi[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv y for variable chi 
		_RSWS_deriv42_y((double *) unzipVarOutShared,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		// computing deriv yz for variable chi 
		_RSWS_deriv42_z((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_1_2_chi[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);

		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_1_chi[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv z for variable chi 
		_RSWS_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_2_chi[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		_RSWS_deriv42_xx((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		_RSWS_deriv42_yy((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad2_1_1_chi[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_1_1_chi[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42_zz((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad2_2_2_chi[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		_RSWS_ko_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_0_chi[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_0_chi[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_ko_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		_RSWS_ko_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_chi[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_2_chi[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_chi[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta0 , 3, bflag);
		_RSWS_deriv42adv_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta1 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_1_chi[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_1_chi[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta2 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_chi[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		//load input data from global to shared memory
		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_GT0][offset],(double *) unzipVarInShared,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		//sync to make sure all the data is loaded
		// computing deriv x for variable Gt0 
		_RSWS_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_0_Gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv y for variable Gt0 
		_RSWS_deriv42_y((double *) unzipVarOutShared,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_1_Gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv z for variable Gt0 
		_RSWS_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_2_Gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();


		_RSWS_ko_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		_RSWS_ko_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_1_Gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_1_Gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_ko_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_Gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta0 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_0_Gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_0_Gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta1 , 3, bflag);
		_RSWS_deriv42adv_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta2 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_Gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_2_Gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_Gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		//load input data from global to shared memory
		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_GT1][offset],(double *) unzipVarInShared,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		//sync to make sure all the data is loaded
		// computing deriv x for variable Gt1 
		_RSWS_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_0_Gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv y for variable Gt1 
		_RSWS_deriv42_y((double *) unzipVarOutShared,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_1_Gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv z for variable Gt1 
		_RSWS_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_2_Gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();


		_RSWS_ko_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		_RSWS_ko_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_1_Gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_1_Gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_ko_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_Gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta0 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_0_Gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_0_Gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta1 , 3, bflag);
		_RSWS_deriv42adv_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta2 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_Gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_2_Gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_Gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		//load input data from global to shared memory
		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_GT2][offset],(double *) unzipVarInShared,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		//sync to make sure all the data is loaded
		// computing deriv x for variable Gt2 
		_RSWS_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_0_Gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv y for variable Gt2 
		_RSWS_deriv42_y((double *) unzipVarOutShared,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_1_Gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv z for variable Gt2 
		_RSWS_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_2_Gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();


		_RSWS_ko_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		_RSWS_ko_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_1_Gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_1_Gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_ko_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_Gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta0 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_0_Gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_0_Gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta1 , 3, bflag);
		_RSWS_deriv42adv_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta2 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_Gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_2_Gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_Gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		//load input data from global to shared memory
		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_K][offset],(double *) unzipVarInShared,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		//sync to make sure all the data is loaded
		// computing deriv x for variable K 
		_RSWS_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_0_K[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv y for variable K 
		_RSWS_deriv42_y((double *) unzipVarOutShared,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_1_K[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv z for variable K 
		_RSWS_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_2_K[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();


		_RSWS_ko_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		_RSWS_ko_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_1_K[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_1_K[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_ko_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_K[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta0 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_0_K[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_0_K[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta1 , 3, bflag);
		_RSWS_deriv42adv_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta2 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_K[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_2_K[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_K[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		//load input data from global to shared memory
		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_SYMGT0][offset],(double *) unzipVarInShared,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		//sync to make sure all the data is loaded
		// computing deriv x for variable gt0 
		_RSWS_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		// computing deriv xy for variable gt0 
		_RSWS_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_0_1_gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv xz for variable gt0 
		_RSWS_deriv42_z((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_0_2_gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);

		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_0_gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv y for variable gt0 
		_RSWS_deriv42_y((double *) unzipVarOutShared,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		// computing deriv yz for variable gt0 
		_RSWS_deriv42_z((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_1_2_gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);

		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_1_gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv z for variable gt0 
		_RSWS_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_2_gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		_RSWS_deriv42_xx((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		_RSWS_deriv42_yy((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad2_1_1_gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_1_1_gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42_zz((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad2_2_2_gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		_RSWS_ko_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_0_gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_0_gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_ko_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		_RSWS_ko_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_2_gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta0 , 3, bflag);
		_RSWS_deriv42adv_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta1 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_1_gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_1_gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta2 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_gt0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		//load input data from global to shared memory
		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_SYMGT1][offset],(double *) unzipVarInShared,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		//sync to make sure all the data is loaded
		// computing deriv x for variable gt1 
		_RSWS_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		// computing deriv xy for variable gt1 
		_RSWS_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_0_1_gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv xz for variable gt1 
		_RSWS_deriv42_z((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_0_2_gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);

		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_0_gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv y for variable gt1 
		_RSWS_deriv42_y((double *) unzipVarOutShared,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		// computing deriv yz for variable gt1 
		_RSWS_deriv42_z((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_1_2_gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);

		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_1_gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv z for variable gt1 
		_RSWS_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_2_gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		_RSWS_deriv42_xx((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		_RSWS_deriv42_yy((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad2_1_1_gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_1_1_gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42_zz((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad2_2_2_gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		_RSWS_ko_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_0_gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_0_gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_ko_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		_RSWS_ko_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_2_gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta0 , 3, bflag);
		_RSWS_deriv42adv_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta1 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_1_gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_1_gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta2 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_gt1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		//load input data from global to shared memory
		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_SYMGT2][offset],(double *) unzipVarInShared,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		//sync to make sure all the data is loaded
		// computing deriv x for variable gt2 
		_RSWS_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		// computing deriv xy for variable gt2 
		_RSWS_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_0_1_gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv xz for variable gt2 
		_RSWS_deriv42_z((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_0_2_gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);

		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_0_gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv y for variable gt2 
		_RSWS_deriv42_y((double *) unzipVarOutShared,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		// computing deriv yz for variable gt2 
		_RSWS_deriv42_z((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_1_2_gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);

		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_1_gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv z for variable gt2 
		_RSWS_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_2_gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		_RSWS_deriv42_xx((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		_RSWS_deriv42_yy((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad2_1_1_gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_1_1_gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42_zz((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad2_2_2_gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		_RSWS_ko_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_0_gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_0_gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_ko_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		_RSWS_ko_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_2_gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta0 , 3, bflag);
		_RSWS_deriv42adv_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta1 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_1_gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_1_gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta2 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_gt2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		//load input data from global to shared memory
		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_SYMGT3][offset],(double *) unzipVarInShared,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		//sync to make sure all the data is loaded
		// computing deriv x for variable gt3 
		_RSWS_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		// computing deriv xy for variable gt3 
		_RSWS_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_0_1_gt3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv xz for variable gt3 
		_RSWS_deriv42_z((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_0_2_gt3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);

		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_0_gt3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv y for variable gt3 
		_RSWS_deriv42_y((double *) unzipVarOutShared,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		// computing deriv yz for variable gt3 
		_RSWS_deriv42_z((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_1_2_gt3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);

		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_1_gt3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv z for variable gt3 
		_RSWS_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_2_gt3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		_RSWS_deriv42_xx((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		_RSWS_deriv42_yy((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad2_1_1_gt3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_1_1_gt3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42_zz((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad2_2_2_gt3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		_RSWS_ko_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_0_gt3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_0_gt3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_ko_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		_RSWS_ko_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_gt3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_2_gt3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_gt3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta0 , 3, bflag);
		_RSWS_deriv42adv_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta1 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_1_gt3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_1_gt3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta2 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_gt3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		//load input data from global to shared memory
		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_SYMGT4][offset],(double *) unzipVarInShared,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		//sync to make sure all the data is loaded
		// computing deriv x for variable gt4 
		_RSWS_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		// computing deriv xy for variable gt4 
		_RSWS_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_0_1_gt4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv xz for variable gt4 
		_RSWS_deriv42_z((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_0_2_gt4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);

		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_0_gt4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv y for variable gt4 
		_RSWS_deriv42_y((double *) unzipVarOutShared,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		// computing deriv yz for variable gt4 
		_RSWS_deriv42_z((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_1_2_gt4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);

		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_1_gt4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv z for variable gt4 
		_RSWS_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_2_gt4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		_RSWS_deriv42_xx((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		_RSWS_deriv42_yy((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad2_1_1_gt4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_1_1_gt4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42_zz((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad2_2_2_gt4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		_RSWS_ko_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_0_gt4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_0_gt4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_ko_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		_RSWS_ko_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_gt4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_2_gt4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_gt4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta0 , 3, bflag);
		_RSWS_deriv42adv_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta1 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_1_gt4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_1_gt4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta2 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_gt4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		//load input data from global to shared memory
		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_SYMGT5][offset],(double *) unzipVarInShared,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		//sync to make sure all the data is loaded
		// computing deriv x for variable gt5 
		_RSWS_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		// computing deriv xy for variable gt5 
		_RSWS_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_0_1_gt5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv xz for variable gt5 
		_RSWS_deriv42_z((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_0_2_gt5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);

		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_0_gt5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv y for variable gt5 
		_RSWS_deriv42_y((double *) unzipVarOutShared,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		// computing deriv yz for variable gt5 
		_RSWS_deriv42_z((double *) unzipVarOutShared1,(const double *) unzipVarOutShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_1_2_gt5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);

		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_1_gt5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv z for variable gt5 
		_RSWS_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_2_gt5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		_RSWS_deriv42_xx((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		_RSWS_deriv42_yy((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad2_1_1_gt5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__grad2_1_1_gt5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42_zz((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad2_2_2_gt5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		_RSWS_ko_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_0_gt5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_0_gt5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_ko_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		_RSWS_ko_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_gt5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_2_gt5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_gt5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta0 , 3, bflag);
		_RSWS_deriv42adv_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta1 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_1_gt5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_1_gt5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta2 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_gt5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		//load input data from global to shared memory
		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_SYMAT0][offset],(double *) unzipVarInShared,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		//sync to make sure all the data is loaded
		// computing deriv x for variable At0 
		_RSWS_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_0_At0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv y for variable At0 
		_RSWS_deriv42_y((double *) unzipVarOutShared,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_1_At0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv z for variable At0 
		_RSWS_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_2_At0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();


		_RSWS_ko_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		_RSWS_ko_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_1_At0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_1_At0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_ko_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_At0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta0 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_0_At0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_0_At0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta1 , 3, bflag);
		_RSWS_deriv42adv_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta2 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_At0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_2_At0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_At0[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		//load input data from global to shared memory
		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_SYMAT1][offset],(double *) unzipVarInShared,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		//sync to make sure all the data is loaded
		// computing deriv x for variable At1 
		_RSWS_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_0_At1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv y for variable At1 
		_RSWS_deriv42_y((double *) unzipVarOutShared,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_1_At1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv z for variable At1 
		_RSWS_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_2_At1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();


		_RSWS_ko_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		_RSWS_ko_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_1_At1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_1_At1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_ko_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_At1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta0 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_0_At1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_0_At1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta1 , 3, bflag);
		_RSWS_deriv42adv_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta2 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_At1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_2_At1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_At1[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		//load input data from global to shared memory
		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_SYMAT2][offset],(double *) unzipVarInShared,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		//sync to make sure all the data is loaded
		// computing deriv x for variable At2 
		_RSWS_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_0_At2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv y for variable At2 
		_RSWS_deriv42_y((double *) unzipVarOutShared,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_1_At2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv z for variable At2 
		_RSWS_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_2_At2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();


		_RSWS_ko_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		_RSWS_ko_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_1_At2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_1_At2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_ko_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_At2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta0 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_0_At2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_0_At2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta1 , 3, bflag);
		_RSWS_deriv42adv_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta2 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_At2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_2_At2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_At2[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		//load input data from global to shared memory
		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_SYMAT3][offset],(double *) unzipVarInShared,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		//sync to make sure all the data is loaded
		// computing deriv x for variable At3 
		_RSWS_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_0_At3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv y for variable At3 
		_RSWS_deriv42_y((double *) unzipVarOutShared,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_1_At3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv z for variable At3 
		_RSWS_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_2_At3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();


		_RSWS_ko_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		_RSWS_ko_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_1_At3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_1_At3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_ko_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_At3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta0 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_0_At3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_0_At3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta1 , 3, bflag);
		_RSWS_deriv42adv_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta2 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_At3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_2_At3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_At3[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		//load input data from global to shared memory
		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_SYMAT4][offset],(double *) unzipVarInShared,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		//sync to make sure all the data is loaded
		// computing deriv x for variable At4 
		_RSWS_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_0_At4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv y for variable At4 
		_RSWS_deriv42_y((double *) unzipVarOutShared,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_1_At4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv z for variable At4 
		_RSWS_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_2_At4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();


		_RSWS_ko_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		_RSWS_ko_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_1_At4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_1_At4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_ko_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_At4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta0 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_0_At4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_0_At4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta1 , 3, bflag);
		_RSWS_deriv42adv_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta2 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_At4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_2_At4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_At4[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		//load input data from global to shared memory
		cuda::__loadGlobalToShared3D<double>(&__unzipInVar[cuda::VAR::U_SYMAT5][offset],(double *) unzipVarInShared,(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		//sync to make sure all the data is loaded
		// computing deriv x for variable At5 
		_RSWS_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_0_At5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv y for variable At5 
		_RSWS_deriv42_y((double *) unzipVarOutShared,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_1_At5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();

		// computing deriv z for variable At5 
		_RSWS_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 2, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__grad_2_At5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();


		_RSWS_ko_deriv42_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		_RSWS_ko_deriv42_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_1_At5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__kograd_1_At5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_ko_deriv42_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz,(const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__kograd_2_At5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_x((double *) unzipVarOutShared,(const double *) unzipVarInShared,dx, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta0 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_0_At5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_0_At5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		_RSWS_deriv42adv_y((double *) unzipVarOutShared1,(const double *) unzipVarInShared,dy, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta1 , 3, bflag);
		_RSWS_deriv42adv_z((double *) unzipVarOutShared,(const double *) unzipVarInShared,dz, (const unsigned int *) ijk_lm , (const unsigned int *) alignedSz , (const unsigned int *) tile_sz, (const bool*) beta2 , 3, bflag);
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_At5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared1,&(__derivWorkspace->__agrad_2_At5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		__syncthreads();
		cuda::__storeSharedToGlobal3D<double>((double *) unzipVarOutShared,&(__derivWorkspace->__agrad_2_At5[SM_ID*(__derivWorkspace->__maxBlkSz)]),(const unsigned int *) ijk_lm,(const unsigned int *) alignedSz,(const unsigned int *) tile_sz);
		__syncthreads();
		} // end of block tile loop

} // end of block assigned to gpu block loop __RSWS_computeDerivs

} // end of kernel __RSWS_computeDerivs


}// end of namespace cuda
